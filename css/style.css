:root{
  --bg:#e8f3ff; --card:#fff; --ink:#0f172a; --muted:#64748b;
  --primary:#4f46e5; --accent:#06b6d4; --ok:#10b981;
  --shadow:0 8px 24px rgba(2,6,23,.12); --radius:20px;
}

/* ===== Base ===== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:ui-rounded,system-ui,Segoe UI,Roboto,sans-serif;
  color:var(--ink); background:var(--bg); display:flex; flex-direction:column; overflow-x:hidden
}

/* ===== Cielo ===== */
.sky{position:fixed; inset:0; z-index:-2; background:linear-gradient(180deg,#88c8ff,#e4effa)}
.cloud{position:absolute; top:10%; width:200px; height:70px; background:#fff; border-radius:50px;
  filter:blur(1px) drop-shadow(0 10px 20px rgba(2,6,23,.12)); opacity:.8; animation:drift 70s linear infinite}
.cloud:before,.cloud:after{content:""; position:absolute; background:#fff; width:120px; height:120px; border-radius:60px; top:-30px}
.cloud:before{left:20px} .cloud:after{left:100px; top:-40px}
.c1{left:-220px; top:18%} .c2{left:-260px; top:35%; animation-duration:95s} .c3{left:-240px; top:60%; animation-duration:80s}
@keyframes drift{from{transform:translateX(0)} to{transform:translateX(130vw)}}

/* ===== Mascota ===== */
.mascota{position:fixed; bottom:70px; left:20px; z-index:60; transform:rotate(-8deg);
  animation:flotar 4s ease-in-out infinite; transition:transform .3s ease, scale .3s ease}
.mascota:hover{transform:rotate(-2deg) scale(1.05)}
.mascota img{width:140px; user-select:none; filter:drop-shadow(0 5px 10px rgba(0,0,0,.2)); pointer-events:auto}
@keyframes flotar{0%,100%{transform:translateY(0) rotate(-8deg)} 50%{transform:translateY(-4px) rotate(-6deg)}}

/* ===== Header ===== */
header{position:sticky; top:0; background:rgba(255,255,255,.85); backdrop-filter:blur(10px);
  border-bottom:1px solid #e2e8f0; z-index:5}
.head-inner{max-width:1100px; margin:0 auto; padding:14px 16px; display:flex; align-items:center; gap:14px}
h1{font-size:20px; margin:0}

/* ===== Layout principal ===== */
main{max-width:1100px; margin:0 auto; width:100%; padding:20px 16px 90px}
.grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:18px}
.card{background:var(--card); border:1px solid #e2e8f0; border-radius:var(--radius); padding:18px; box-shadow:var(--shadow); text-align:center}
.big-emoji{font-size:54px}

/* Botones & Pills */
.btn,.pill{
  display:inline-flex; align-items:center; justify-content:center;
  height:40px; padding:0 14px; border-radius:9999px; background:#fff; border:1px solid #E5E7EB;
  font:600 14px/1 system-ui,-apple-system,"Segoe UI",Roboto,sans-serif; color:#111827; cursor:pointer;
  transition:transform .12s ease, box-shadow .12s ease, border-color .2s ease; box-shadow:none
}
.btn:hover,.pill:hover{transform:translateY(-1px); box-shadow:0 6px 14px rgba(0,0,0,.08)}
.btn.primary{background:var(--primary); border-color:var(--primary); color:#fff}
.btn.primary:hover{box-shadow:0 12px 22px rgba(79,70,229,.36)}
.card button{margin-top:10px; padding:12px 16px; border:none; border-radius:14px; background:var(--primary); color:#fff; font-weight:700; cursor:pointer}
.card button.secondary{background:var(--ok)}


.nav-btn-home {
  display: inline-flex;
  align-items: center;
  gap: .4rem;
  padding: .4rem .8rem;
  border-radius: 999px;
  border: none;
  background: #ffffffea;
  cursor: pointer;
  box-shadow: 0 2px 5px rgba(0,0,0,.15);
  font-weight: 600;
}

.nav-btn-home:hover {
  transform: translateY(-1px);
  box-shadow: 0 3px 7px rgba(0,0,0,.2);
}

.nav-home-icon {
  width: 40px;
  height: 40px;
  object-fit: contain;
}


/* ===== Screens ===== */
.screen{display:none}
.screen.active{display:block}
.screen .bar{display:flex; align-items:center; gap:12px; padding:10px 14px}
.screen .bar .pill[data-active="1"]{border-color:#60A5FA}
#btnModo{position:relative; padding-right:48px}
#btnModo::after{content:""; position:absolute; right:10px; top:50%; transform:translateY(-50%);
  width:34px; height:18px; border-radius:9999px; background:#E5E7EB; border:1px solid rgba(0,0,0,.08); transition:background .18s,border-color .18s}
#btnModo::before{content:""; position:absolute; right:28px; top:50%; transform:translateY(-50%);
  width:14px; height:14px; border-radius:50%; background:#fff; box-shadow:0 1px 2px rgba(0,0,0,.25); transition:right .18s}
#btnModo[data-on="1"]::after{background:#22C55E; border-color:#22C55E}
#btnModo[data-on="1"]::before{right:12px}

/* ===== Stage ===== */
.stage{position:relative; background:#f8fbff; min-height:490px; border:1px solid #e2e8f0;border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden}

/* ===== BARRA DE PROGRESO ===== */
.progress {position: absolute;left: 20px;right: 20px;top: 18px;display: flex;align-items: center;justify-content: center;z-index: 5;}
#pwrap {display: grid;grid-template-columns: repeat(10, 1fr);gap: 6px;width: 100%;height: 18px;border-radius: 999px;
    background: rgba(2, 6, 23, 0.08);padding: 3px;border: 1px solid rgba(14, 165, 233, 0.4);box-shadow: inset 0 1px 2px rgba(0, 0, 0, .1);}
#pwrap .seg {height: 12px;background: #e0f2fe;border-radius: 999px;transition: all 0.25s ease;border: 1px solid rgba(14, 165, 233, 0.2);
    box-shadow: inset 0 1px 2px rgba(255, 255, 255, .8);}
#pwrap .seg.on {background: linear-gradient(90deg, #11ff68 0%, #20d44d 100%);border-color: transparent;
    box-shadow:0 0 4px rgba(17, 238, 98, 0.4),inset 0 0 0 1px rgba(255, 255, 255, 0.375);transform: scaleY(1.1);}

/* animación suave de llenado */
#pwrap .seg.on {animation: infinite 0.4s infinite;}
@keyframes fillSegment {from { transform: scaleX(0.5); opacity: 0.6; }to   { transform: scaleX(1); opacity: 1; }}

/* versión móvil */
@media (max-width: 600px) {#pwrap {height: 14px;gap: 4px;}#pwrap .seg {height: 10px;}}

/* ===== Globos ===== */
.progress{position:absolute; left:14px; right:14px; top:14px; display:flex; gap:10px; align-items:center; z-index:2}
.balloon-area{position:absolute; inset:0; overflow:hidden}
.balloon{position:absolute; bottom:-80px; font-size:62px; cursor:pointer; user-select:none; will-change:transform,opacity;
  filter:drop-shadow(0 10px 18px rgba(2,6,23,.12))}
.balloon.pop{transition:transform .18s ease-out, opacity .18s ease-out; transform:scale(1.25); opacity:0}

/* ===== Piano-teclas ===== */
.kbd-wrap{position:absolute; inset:0; display:grid; place-items:center; text-align:center; z-index:1}
.big-key{background:#fff; border:1px solid #e2e8f0; border-radius:18px; padding:28px 24px; box-shadow:var(--shadow);
  font-size:clamp(42px,8vw,96px); font-weight:900}
.sub{margin-top:8px; color:var(--muted); font-weight:700}
.rainbow-tray{position:absolute; inset:0; overflow:hidden; pointer-events:none; z-index:0}
.rain{position:absolute; left:0; right:0; height:22px; opacity:.95; animation:slideUp 1.2s ease-out forwards}
@keyframes slideUp{from{transform:translateY(40px); opacity:.9} to{transform:translateY(-120%); opacity:0}}

/* Imagen grande */
.piano-pic {
  position: absolute;
  left: 50%;
  top: 45%;
  transform: translate(-50%, -50%) scale(0.6);
  max-width: 420px;
  width: 48vw;
  opacity: 0;
  pointer-events: none;
  filter: drop-shadow(0 22px 32px rgba(0,0,0,.3));
}

/* Cartel ¡Bravo! */
.piano-bravo {
  position: absolute;
  left: 50%;
  top: calc(45% + 180px); /* Debajo de la imagen */
  transform: translateX(-50%) scale(0.5);
  padding: 14px 32px;
  border-radius: 20px;
  background: white;
  color: #0f172a;
  font-weight: 900;
  font-size: 2.2rem;
  opacity: 0;
  pointer-events: none;
  box-shadow: 0 10px 20px rgba(0,0,0,.12);
}


/* ===== Letras ===== */
.big-key.celebrate {
  animation: pop-key 0.2s ease-out;
}
@keyframes pop-key {
  0%   { transform: scale(1); }
  50%  { transform: scale(1.1); }
  100% { transform: scale(1); }
}

/* ===== Clic suave ===== */
.mouseHUD{position:absolute; left:14px; top:14px; display:flex; gap:8px; z-index:1}
.counter{background:#fff; border:1px solid #e2e8f0; border-radius:12px; padding:8px 10px; box-shadow:var(--shadow)}
.click-area{position:absolute; inset:0}
.pulse{position:absolute; width:12px; height:12px; border-radius:999px; border:3px solid var(--accent); transform:translate(-50%,-50%); opacity:0; animation:pulse .6s ease-out forwards}
@keyframes pulse{from{opacity:.9; scale:1} to{opacity:0; scale:3}}
.toast{position:absolute; right:14px; bottom:14px; background:#fff; border:1px solid #e2e8f0; border-radius:12px; padding:10px 12px;
  box-shadow:var(--shadow); opacity:0; transform:translateY(8px); transition:.25s}
.toast.show{opacity:1; transform:translateY(0)}
.mouse-ghost{position:absolute; pointer-events:none; width:100px; height:145px; translate:-50% -50%; opacity:.95}
.mouse .body{fill:#fff; stroke:#cbd5e1; stroke-width:2}
.mouse .btn{fill:#e2e8f0}
.mouse .btn.active-left{fill:#86efac}
.mouse .btn.active-right{fill:#fe8e8e}
.mouse .btn{ transition: fill .04s ease; }

/* ===== Casitas ===== */
.drag-wrap{position:absolute; inset:0; display:grid; grid-template-columns:1fr 1fr; gap:16px; padding:16px}
.dropzone{
  --house:#fffaf2; --grass:#dff6e1; --stroke:rgba(0,0,0,.06);
  position:relative; display:grid; place-items:center; min-height:clamp(140px,22vh,180px);
  border-radius:16px; padding:8px; margin:10px;
  background:linear-gradient(to bottom,transparent 0 72%, var(--grass) 72% 100%), var(--house);
  box-shadow:0 8px 18px rgba(0,0,0,.06), inset 0 0 0 2px var(--stroke); transition:transform .2s, box-shadow .2s}
.dropzone:hover{transform:translateY(-2px); box-shadow:0 10px 22px rgba(0,0,0,.09), inset 0 0 0 2px var(--stroke)}
.dropzone::after{content:""; position:absolute; bottom:14px; left:50%; width:28px; height:38px; transform:translateX(-50%);
  background:linear-gradient(#7a6251,#5b4636); border-radius:8px 8px 4px 4px; box-shadow:inset 0 0 0 2px rgba(0,0,0,.05)}
.dropzone .ghost{position:relative; font-size:clamp(40px,6vw,64px); opacity:.35; filter:saturate(.6) contrast(.95); user-select:none; pointer-events:none}
.dropzone .ghost::after{content:""; position:absolute; inset:-12px -14px; border:3px dashed #7dd3fc; border-radius:14px; box-shadow:inset 0 2px 0 rgba(0,0,0,.04)}
.dropzone.correct{box-shadow:0 14px 26px rgba(0,0,0,.12), inset 0 0 0 2px rgba(16,185,129,.25);
  background:linear-gradient(to bottom,transparent 0 72%, #d3f7d8 72% 100%), #fffef7; animation:yay .35s ease}
.dropzone.correct .ghost,.dropzone.correct .ghost::after{visibility:hidden; display:none}
@keyframes yay{0%{transform:translateY(0) scale(1)} 40%{transform:translateY(-5px) scale(1.02)} 100%{transform:translateY(0) scale(1)}}
.palette{background:#fff; border:1px solid #e2e8f0; border-radius:16px; padding:12px; display:flex; flex-wrap:wrap; gap:12px;
  align-content:flex-start; min-height:160px; overflow:auto}
.piece{font-size:56px; cursor:grab; user-select:none; display:inline-block}
.piece.dragging{opacity:.7; transform:scale(1.1); cursor:grabbing}
.dropzone .piece.placed{position:absolute; left:50%; top:38%; transform:translate(-50%,-50%); font-size:clamp(44px,6.5vw,72px);
  filter:drop-shadow(0 3px 2px rgba(0,0,0,.12)); pointer-events:none}
/* ===== Overlay turnos ===== */
.overlay{position:fixed; inset:0; background:rgba(15,23,42,.55); display:none; align-items:center; justify-content:center; z-index:70; backdrop-filter:blur(3px)}
.overlay.show{display:flex}
.card{background:#fff; border:1px solid #e2e8f0; border-radius:24px; padding:24px; width:min(520px,92%); text-align:center; box-shadow:var(--shadow)}
.count{font-size:clamp(48px,10vw,96px); font-weight:900; color:var(--primary)}

.turn-img {width: 200px;max-width: 90%;height: auto;display: block;margin: 12px auto 20px;filter: drop-shadow(0 4px 10px rgba(0,0,0,0.15));animation: popIn 0.4s ease-out;
}
@keyframes popIn {
  from { transform: scale(0.8); opacity: 0; } to   { transform: scale(1); opacity: 1; }
}

/* ===== Dock ===== */
.dock{position:fixed; left:0; right:0; bottom:0; padding:10px 16px; background:rgba(255,255,255,.9);
  border-top:1px solid #e2e8f0; display:flex; gap:8px; align-items:center; backdrop-filter:blur(8px); z-index:4}
.tag{background:#fff; border:1px solid #e2e8f0; border-radius:10px; padding:6px 10px; box-shadow:var(--shadow); font-weight:700}
.push{flex:1}

/* ===== Confeti global ===== */
#confetti{pointer-events:none; position:fixed; inset:0; overflow:hidden; z-index:9999}
.conf{position:absolute; width:10px; height:14px; opacity:.9; transform:rotate(0)}

/* ===== Laberinto (único y centralizado) ===== */
.maze{
--th:84px;position:relative;width:min(920px,96%);height:460px;margin:18px auto;border:1px solid #f4e4a6;border-radius:20px;box-shadow:var(--shadow);overflow:hidden;
background-color:#fffdf5;background-image:radial-gradient(circle, rgba(255, 208, 95, .22) 1.2px, transparent 1.2px); background-size: 28px 28px;
}
.maze.easy{--th:100px}
.maze .track{position:absolute; z-index:1; height:var(--th); background:#ffe38e; border-radius:calc(var(--th)/2)}
/* Trayecto conectado: horizontal arriba → bajada → horizontal abajo */
.maze .track.t1{left:80px;  top:100px; width:820px; height:110px}
.maze .track.t2{left:260px; top:150px; width:150px; height:220px}
.maze .track.t3{left:260px; top:280px; width:620px; height:110px}
/* Dots (el JS los posiciona) */
.maze .dot{position:absolute; z-index:2; display:grid; place-items:center; width:60px; height:60px; border-radius:50%;
  font-size:34px; user-select:none; pointer-events:none}
.maze .dot.start{background:#eef2ff; border:2px solid #c7d2fe}
.maze .dot.goal{background:#fff7ed; border:2px solid #fed7aa; animation:goalPulse 1.4s ease-out infinite}
@keyframes goalPulse{0%{box-shadow:0 0 0 0 rgba(251,191,36,.45)} 100%{box-shadow:0 0 0 22px rgba(251,191,36,0)}}
/* Jugador */
.maze .player{position:absolute; z-index:3; width:60px; height:60px; border-radius:50%;
  display:grid; place-items:center; font-size:34px; background:#fff; border:2px solid #cbd5e1; box-shadow:0 8px 18px rgba(0,0,0,.08);
  cursor:grab; user-select:none; transition:box-shadow .15s ease}
.maze .player.dragging{cursor:grabbing; box-shadow:0 12px 22px rgba(0,0,0,.12)}
/* Feedback fallo */
.maze.fail{animation:mazeFail .25s ease}
@keyframes mazeFail{0%{transform:translateX(0)} 25%{transform:translateX(-4px)} 50%{transform:translateX(4px)} 100%{transform:translateX(0)}}

/* ===== Popup “abeja consiguió las flores” ===== */
.bee-pop{position:fixed; inset:0; display:none; align-items:center; justify-content:center;
  background:rgba(15, 23, 42, 0.055); backdrop-filter:blur(2px); z-index:70; animation:fadeIn .18s ease-out}
.bee-pop.show{display:flex}
.bee-card{background:#ffffff37; border-radius:18px; padding:16px; box-shadow:var(--shadow); transform:scale(.9); animation:popIn .22s ease-out forwards}
.bee-card img{width:min(320px,70vw); height:auto; display:block}
@keyframes popIn{to{transform:scale(1)}} @keyframes fadeIn{from{opacity:0} to{opacity:1}}

/* Usa el mismo toggle de Globos para el del Laberinto */
#btnModo, #btnMazeMode {
  position: relative;
  padding-right: 48px;
}
#btnModo::after, #btnMazeMode::after {
  content:""; position:absolute; right:10px; top:50%; transform:translateY(-50%);
  width:34px; height:18px; border-radius:9999px; background:#E5E7EB; border:1px solid rgba(0,0,0,.08);
  transition: background .18s ease, border-color .18s ease;
}
#btnModo::before, #btnMazeMode::before {
  content:""; position:absolute; right:28px; top:50%; transform:translateY(-50%);
  width:14px; height:14px; border-radius:50%; background:#fff; box-shadow:0 1px 2px rgba(0,0,0,.25);
  transition:right .18s ease;
}
#btnModo[data-on="1"]::after, #btnMazeMode[data-on="1"]::after { background:#22C55E; border-color:#22C55E; }
#btnModo[data-on="1"]::before, #btnMazeMode[data-on="1"]::before { right:12px; }

/* Oculta pistas en modo libre */
.maze.free .track { display:none; }

/* ===== Ratón y Queso ===== */
.cheese-stage{
  position: relative;
  width: 100%;
  height: 100%;
  background: #88dffc;
  border: 1px dashed #e2e8f0;
  border-radius: 16px;
}

.cheese-mouse,
.cheese-goal{
  position: absolute;
  width: 60px;
  height: 60px;
  display: grid;
  place-items: center;
  font-size: 34px;
  user-select: none;
  pointer-events: auto; /* el mouse debe poder recibir el pointerdown */
  filter: drop-shadow(0 6px 12px rgba(2,6,23,.12));
}

.cheese-mouse{ background:#fff; border:2px solid #cbd5e1; border-radius:50%; cursor: grab;}
.cheese-goal { background:#fff7ed; border:2px solid #fed7aa; border-radius:50%;
  animation: goalPulse 1.4s ease-out infinite; }

  /* ===== Sorting de Colores ===== */
.shelf{
  position:absolute; left:16px; right:16px; top:60px;
  display:grid; grid-template-columns:repeat(4,1fr); gap:14px; z-index:2;
}
.bin{
  position:relative; background:#fff; border:1px solid #e2e8f0; border-radius:16px;
  box-shadow:var(--shadow); padding:10px 10px 14px; display:grid; place-items:center; gap:6px;
}
.bin span{font-weight:800; color:#334155; font-size:14px}
.bin-hole{
  width:78px; height:38px; border-radius:22px; background:#f1f5f9;
  box-shadow: inset 0 2px 6px rgba(0,0,0,.08);
}

/* campo de pelotas */
.color-field{
  position:absolute; inset:120px 16px 16px 16px; border-radius:16px; background:#abcfff;
  border:1px solid #e2e8f0; box-shadow: inset 0 0 0 1px rgba(0,0,0,.02);
}

/* pelotas */
.ball{
  position:absolute; width:48px; height:48px; border-radius:50%;
  box-shadow:0 6px 14px rgba(2,6,23,.12), inset 0 0 0 2px rgba(255,255,255,.7);
  cursor:grab; user-select:none; touch-action:none; display:grid; place-items:center; color:#fff; font-size:18px; font-weight:900;
  transition:transform .12s ease, box-shadow .12s ease;
}
.ball.dragging{ cursor:grabbing; transform:scale(1.08); box-shadow:0 10px 22px rgba(2,6,23,.18); z-index:5 !important; }

/* colores suaves y accesibles */
.clr-rojo     { background:#ef4444; }
.clr-amarillo { background:#f5f50b; color:#111; }
.clr-morado   { background:#8b5cf6; }
.clr-azul     { background:#3b82f6; }

/* feedback al bin correcto */
.bin.correct{ box-shadow:0 14px 26px rgba(0,0,0,.12), inset 0 0 0 2px rgba(16,185,129,.25); }

/* ===== Sorting de Colores: bins coloreados ===== */
#scr-sort .bin{
  border:1px solid #e2e8f0;
  transition: box-shadow .2s ease, transform .12s ease, border-color .2s ease;
}
#scr-sort .bin .bin-hole{
  width:78px; height:38px; border-radius:22px; background:#f1f5f9;
  box-shadow: inset 0 2px 6px rgba(0,0,0,.08);
}

/* Colores del hueco y aro del bin */
#scr-sort .bin[data-color="rojo"]     { border-color: rgba(239,68,68,.25); }
#scr-sort .bin[data-color="amarillo"] { border-color: rgba(245,158,11,.25); }
#scr-sort .bin[data-color="morado"]   { border-color: rgba(139,92,246,.25); }
#scr-sort .bin[data-color="azul"]     { border-color: rgba(59,130,246,.25); }

#scr-sort .bin[data-color="rojo"]     .bin-hole{ background-color: #ef4444; }
#scr-sort .bin[data-color="amarillo"] .bin-hole{ background-color: #f5f50b;; }
#scr-sort .bin[data-color="morado"]   .bin-hole{ background-color: #8b5cf6; }
#scr-sort .bin[data-color="azul"]     .bin-hole{ background-color: #3b82f6; }

/* Destacar el color objetivo */
/* ===== Borde resaltado del color objetivo ===== */
/* ===== Resaltado dinámico del color objetivo ===== */
#scr-sort .bin.target {
  --highlight: #22c55e; border: 5px solid var(--highlight);
  box-shadow:0 0 14px 4px var(--highlight),inset 0 0 8px var(--highlight);transform: scale(1.05);
  transition: all 0.3s ease;animation: pulseTarget 1.3s ease-in-out infinite;
}

/* Animación del brillo */
@keyframes pulseTarget { 0%, 100% { box-shadow: 0 0 12px 4px var(--highlight),inset 0 0 6px var(--highlight); transform: scale(1.05);
} 50% { box-shadow: 0 0 22px 6px var(--highlight), inset 0 0 10px var(--highlight);transform: scale(1.08);}}


/* =================== HÁBITATS (scope) =================== */
#scr-habitats .hab-rails{ position: relative; width: min(1200px, 96%); height: clamp(420px, 65vh, 560px);
margin: 14px auto 0; border-radius: 18px; background: #f8fafc; box-shadow: var(--shadow); overflow: hidden;
display: grid; grid-template-columns: 1fr 1fr; border: 1px solid #e2e8f0;}
#scr-habitats .hab-side{ position: relative; overflow: hidden;}
#scr-habitats .hab-side + .hab-side{border-left: 2px dashed #e2e8f0;}
#scr-habitats .hab-bg{ position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; opacity: .92; z-index: 0;}
#scr-habitats .hab-chip{ position: absolute; top: 14px; left: 50%; transform: translateX(-50%); z-index: 2;
background: #fff; padding: .5rem 1rem; border-radius: 12px; font-weight: 800; color: #0f172a; box-shadow: 0 2px 8px rgba(15,23,42,.1);}
#scr-habitats .hab-pile{
  position: absolute; left: 10px; right: 10px; bottom: 12px; z-index: 2;
  display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;
  background: rgba(255,255,255,.45); border-radius: 10px; padding: 6px;
  backdrop-filter: blur(2px);
}
#scr-habitats .hab-thumb{
  width: 56px; height: 56px; object-fit: contain;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,.1));
}
#scr-habitats .hab-animal{
  position: absolute; left: 50%; top: 50%;
  transform: translate(-50%, -50%);
  width: 140px; height: 140px; object-fit: contain;
  cursor: pointer; z-index: 3; user-select: none;
  filter: drop-shadow(0 10px 22px rgba(15,23,42,.15));
  background-color: #ffffff9b;
  border-radius: 50px;
}

/* Evitar arrastre nativo de imágenes (Safari/Chrome) */
.hab-animal { -webkit-user-drag: none; user-select: none; }

/* Capas para que todo conviva sin estorbar */
.hab-bg        { z-index: 0; }
.hab-pile      { z-index: 2; }
.hab-letrero   { z-index: 3; }
.hab-animal    { z-index: 4; }  /* el sprite encima de los letreros */

/* Letreros */
.hab-letrero{
  position: absolute;
  top: 14px;
  left: 18px;
  pointer-events: none;
  user-select: none;
  filter: drop-shadow(0 10px 18px rgba(0,0,0,.15));
  width: clamp(150px, 22vw, 280px);
}
.hab-letrero img{
  display: block;
  width: 300px;
  height: 239px;
}

.hab-right .hab-letrero{
  left: -5px;
  right: 10px;
  top: auto;
}

.hab-left .hab-letrero{
  left: -10px;
  right: 10px;
  top: auto;
}

@media (max-width: 700px){
  .hab-letrero{ width: clamp(120px, 28vw, 220px); top: 10px; }
}

/* ===== Dinos: desenterrar fósiles ===== */
.dino-stage{
  position:relative;
  width:min(900px, 96%);
  height:clamp(420px, 60vh, 520px);
  margin:18px auto;
  border-radius:20px;
  overflow:hidden;
  box-shadow:var(--shadow);
  background:#A56D4A;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor: url('img/dino-dig/escoba.png'), auto;
}

.dino-bones{
  width: 550px;
  height: 550;
  object-fit:contain;
  pointer-events:none;
  z-index:1;
}

/* Capa de tierra por encima del fósil */
.dino-grid{
  position:absolute;
  inset:0;
  display:grid;
  grid-template-columns:repeat(10,1fr);   /* 10 columnas = DINO_TILE_COLS */
  grid-auto-rows:1fr;
  border-radius:20px;
  z-index:2;
}

.dino-tile{
  background:
    radial-gradient(circle at 10% 20%, rgba(255,255,255,.25) 0 20%, transparent 22% 100%),
    radial-gradient(circle at 80% 70%, rgba(0,0,0,.12) 0 20%, transparent 22% 100%),
    #b56a35;
  box-shadow:inset 0 0 4px rgba(0,0,0,.3);
  opacity:1;
  transition:opacity .18s ease-out;
  pointer-events:auto;
}

/* cuando “se quita” la tierra */
.dino-tile.gone{
  opacity:0;
  pointer-events:none;
}

/* ----- Tarjetas de dinosaurios sobre el stage ----- */
.dino-choices{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:24px;
  padding:20px;
  z-index:3;
  opacity:0;
  pointer-events:none;
  transition: opacity .25s ease, transform .25s ease;
  transform: translateY(10px);
}

/* Cuando se muestran las tarjetas */
.dino-choices.show{
  opacity:1;
  pointer-events:auto;
  transform: translateY(0);
}

.dino-card{
  width: 420px;
  height: 420px;
  background:#fff;
  border-radius:20px;
  padding:16px 18px;
  border:2px solid transparent;
  box-shadow:0 12px 28px rgba(15,23,42,.25);
  cursor:pointer;
  transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
  will-change: transform, box-shadow, border-color;
  overflow: hidden;
}

.dino-card img{
  width: 100%;           /* tamaño visual uniforme */
  height: 100%;
  max-height: 100%;
  object-fit: contain;   /* mantiene proporciones */
  image-rendering: auto;
  display: block;}

.dino-card:hover{
  transform:translateY(-4px);
  box-shadow:0 18px 32px rgba(15,23,42,.35);
}

.dino-card:focus,
.dino-card:focus-visible,
.dino-card img:focus,
.dino-card img:focus-visible,
.dino-card-img:focus,
.dino-card-img:focus-visible
.dino-card-img img:focus,
.dino-card-img img:focus-visible{
  outline: none !important;
  box-shadow: none !important;
}

.dino-card img,
.dino-bones{
  user-select: none;
  -webkit-user-drag: none;
}

@keyframes cardGlowGreen{
  0%{
    box-shadow:0 12px 28px rgba(15,23,42,.25);
  }
  50%{
    box-shadow:
      0 0 0 3px rgba(34,197,94,.75),
      0 16px 32px rgba(22,163,74,.65);
  }
  100%{
    box-shadow:0 12px 28px rgba(15,23,42,.25);
  }
}

@keyframes cardGlowRed{
  0%{
    box-shadow:0 12px 28px rgba(15,23,42,.25);
  }
  50%{
    box-shadow:
      0 0 0 3px rgba(239,68,68,.8),
      0 16px 32px rgba(185,28,28,.6);
  }
  100%{
    box-shadow:0 12px 28px rgba(15,23,42,.25);
  }
}

.dino-card.correct{
  background-color: #22c55ea6;
  border-color:#22c55e;
  animation: cardGlowGreen .55s ease-out 0s 2 alternate;
}

.dino-card.wrong{
  background-color: #ef4444a6;
  border-color:#ef4444;
  animation: shakeCard .32s ease, cardGlowRed .55s ease-out 0s 2 alternate;
}

/* ===== Panel lumínico ===== */

.panel-mode-buttons{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  justify-content:center;
  margin:10px auto;
}

.panel-board{
  width:min(520px, 90vw);
  height:min(520px, 90vw);
  margin:16px auto 8px;
  border-radius:24px;
  padding:18px;
  box-shadow:var(--shadow);
  background:linear-gradient(135deg,#e0f2fe,#ffffff);
  display:grid;
  gap:14px;
  place-items:center;
}

.panel-cell{
  border-radius:20px;
  border:3px solid #dbeafe;
  background:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,.65) 0 35%, transparent 40% 100%),
    radial-gradient(circle at 80% 70%, rgba(15,23,42,.18) 0 32%, transparent 36% 100%),
    #93c5fd;
  box-shadow:0 8px 18px rgba(15,23,42,.15);
  cursor:pointer;
  transition:
    transform .12s ease,
    box-shadow .12s ease,
    border-color .12s ease,
    background .12s ease;
}

.panel-cell:focus-visible{
  outline:3px solid #2563eb;
  outline-offset:2px;
}

/* Tamaños: se calculan con grid, pero aseguramos botones grandes */
.panel-board.panel-2x2 .panel-cell{ min-width:90px; min-height:90px; }
.panel-board.panel-3x2 .panel-cell{ min-width:80px; min-height:80px; }
.panel-board.panel-3x3 .panel-cell{ min-width:72px; min-height:72px; }

/* Encendido */
.panel-cell.lit{
  background:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,.9) 0 40%, transparent 46% 100%),
    radial-gradient(circle at 80% 70%, rgba(56,189,248,.7) 0 34%, transparent 40% 100%),
    #60a5fa;
  box-shadow:
    0 0 0 3px rgba(191,219,254,1),
    0 0 24px rgba(37,99,235,.85);
  transform:scale(1.03);
}

/* Correcto: destello verde suave */
.panel-cell.correct{
  animation:panelCorrectFlash .35s ease;
  border-color:#22c55e;
}

/* Incorrecto: titileo rojo + shake mini */
.panel-cell.wrong{
  animation:panelWrongFlash .35s ease;
  border-color:#ef4444;
}

@keyframes panelCorrectFlash{
  0%  { box-shadow:0 0 0 0 rgba(34,197,94,.0); }
  30% { box-shadow:0 0 28px 4px rgba(34,197,94,.8); }
  100%{ box-shadow:0 0 0 0 rgba(34,197,94,.0); }
}

@keyframes panelWrongFlash{
  0%  { transform:translateX(0); box-shadow:0 0 0 0 rgba(239,68,68,.0); }
  20% { transform:translateX(-4px); box-shadow:0 0 22px 4px rgba(239,68,68,.75); }
  40% { transform:translateX(4px); }
  60% { transform:translateX(-3px); }
  100%{ transform:translateX(0); box-shadow:0 0 0 0 rgba(239,68,68,.0); }
}

.panel-message{
  text-align:center;
  font-size:1.05rem;
  margin-bottom:10px;
  min-height:1.6em;
}

/* ===== Panel lumínico ===== */

.panel-board{
  width: min(640px, 96%);
  aspect-ratio: 4 / 3;
  margin: 18px auto;
  padding: 32px;
  border-radius: 28px;
  background: linear-gradient(145deg,#eef5ff,#ffffff);
  box-shadow: 0 18px 40px rgba(15,23,42,.16);
  display: grid;
  grid-template-rows: repeat(var(--panel-rows,2), 1fr);
  grid-template-columns: repeat(var(--panel-cols,2), 1fr);
  gap: 32px;
  place-items: center;
}

.panel-btn{
  width: clamp(100px, 18vh, 130px);
  height: clamp(100px, 18vh, 130px);
  border-radius: 26px;
  border: none;
  background: var(--panel-color, #93c5fd);
  box-shadow: 0 10px 22px rgba(15,23,42,.22);
  cursor: pointer;
  transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
}

.panel-btn.lit{
  transform: translateY(-3px);
  box-shadow:
    0 0 0 4px rgba(255,255,255,.9),
    0 0 20px rgba(15,23,42,.35);
  filter: brightness(1.25);
}

.panel-btn.disabled{
  cursor: default;
  opacity: .75;
}

#panel-mode-label,
#panel-info{
  margin-left: 8px;
  padding: 4px 12px;
  border-radius: 999px;
  background: rgba(15,23,42,.06);
  font-size: .9rem;
}

/* ===== Rompecabezas ===== */

.pz-stage{
  margin:18px auto 0;
  max-width:1000px;
  display:flex;
  gap:26px;
  align-items:center;
  justify-content:center;
  padding:10px;
}

/* Lado izquierdo (tablero) */
.pz-left{
  position:relative;
  flex:1 1 60%;
  aspect-ratio:4/3;
  border-radius:26px;
  background:#e5f0ff;
  box-shadow:0 18px 40px rgba(15,23,42,.25);
  overflow:hidden;
}

/* Imagen base opaca */
.pz-base{
  position:absolute;
  inset:0;
  background-image:url("img/puzzle/gallinas-rc.png");
  background-size:cover;
  background-position:center;
  opacity:.35;
  pointer-events:none;
}

/* Cuadrícula donde encajan las piezas */
.pz-grid{
  position:absolute;
  inset:16px;
  display:grid;
  grid-template-columns:repeat(3,1fr);   /* 3x3 */
  grid-auto-rows:1fr;
  gap:8px;
}

/* Cada “casilla” del rompecabezas */
.pz-cell{
  position:relative;
  border-radius:16px;
  border:2px dashed rgba(148,163,184,.9);
  background:rgba(255,255,255,.35);
  box-shadow:
    inset 0 0 0 1px rgba(148,163,184,.18),
    0 4px 8px rgba(15,23,42,.15);
  overflow:hidden;
  transition:border-color .18s ease, box-shadow .18s ease, background .18s ease;
}

/* Cuando la casilla ya tiene la pieza correcta */
.pz-cell.filled{
  border-style:solid;
  border-color:#22c55e;
  background-repeat:no-repeat;
  background-size:300% 300%;  /* 3x3 → 300% */
  background-position:var(--pz-x) var(--pz-y);
  box-shadow:0 12px 24px rgba(15,23,42,.25);
}

/* Lado derecho (piezas) */
.pz-right{
  flex:0 0 260px;
  min-height:320px;
  border-radius:26px;
  background:rgba(255,255,255,.95);
  box-shadow:0 16px 36px rgba(15,23,42,.28);
  padding:14px 16px 16px;
  display:flex;
  flex-direction:column;
  gap:10px;
}

.pz-title{
  font-size:1rem;
  font-weight:600;
  color:#0f172a;
  text-align:center;
  margin-bottom:6px;
}

.pz-pieces{
  position:relative;
  flex:1;
}

/* Piezas del rompecabezas */
.pz-piece{
  position:absolute;
  width:90px;
  height:90px;
  border-radius:18px;
  background-image:url("img/puzzle/gallinas-rc.png");
  background-size:300% 300%;
  background-position:var(--pz-x) var(--pz-y);
  background-repeat:no-repeat;
  box-shadow:0 14px 26px rgba(15,23,42,.35);
  cursor:grab;
  transition:box-shadow .12s ease, transform .12s ease;
}

.pz-piece.dragging{
  cursor:grabbing;
  box-shadow:0 16px 32px rgba(15,23,42,.45);
  transform:scale(1.03);
}

/* shake cuando es incorrecta */
@keyframes pz-shake{
  0%{ transform:translateX(0); }
  25%{ transform:translateX(-6px); }
  50%{ transform:translateX(6px); }
  100%{ transform:translateX(0); }
}

.pz-piece.shake{
  animation:pz-shake .22s ease;
}

/* ===== MATCH EXPRESS ===== */

#scr-match {
  padding: 20px;
}

.match-wrapper {
  max-width: 1080px;
  margin: 0 auto;
}

/* ---------- Header ---------- */

.match-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  margin-bottom: 16px;
}

.match-header-title {
  font-size: 2rem;
  font-weight: 700;
  color: #0f172a;
}

.match-header-sub {
  font-size: 1rem;
  color: #64748b;
}

/* Imagen objetivo (la de arriba) */
.match-target-img {
  margin-top: 6px;
  width: 80px;
  height: 80px;
  max-width: 20vw;
  max-height: 20vw;
  object-fit: contain;
  filter: drop-shadow(0 4px 6px rgba(15,23,42,.25));
}

/* ---------- Tablero ---------- */

.match-board {
  position: relative;
  margin: 0 auto;
  margin-top: 10px;
  width: 100%;
  max-width: 1080px;
  height: 430px;

  background: radial-gradient(circle at top, #eef5ff 0, #f9fbff 45%, #eef5ff 100%);
  border-radius: 30px;
  box-shadow: 0 18px 40px rgba(15,23,42,.18);
  overflow: hidden;
}

/* ---------- Objetos ---------- */

.match-obj {
  position: absolute;
  /* tamaño se setea por JS (width/height) */
  border-radius: 999px;

  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  border: 3px solid transparent;
  background: transparent;
  box-shadow: 0 10px 24px rgba(15,23,42,.25);

  animation: matchFloat 4.5s ease-in-out infinite;
  transition:
    transform .15s ease,
    box-shadow .15s ease,
    border-color .15s ease;
}

.match-obj-img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  pointer-events: none;
}

/* Hover suave */
.match-obj:hover {
  transform: translateY(-3px) scale(1.06);
  box-shadow: 0 14px 32px rgba(15,23,42,.28);
}

/* Seleccionada (primer click) */
.match-obj.selected {
  border-color: #38bdf8;
  box-shadow: 0 16px 34px rgba(56,189,248,.35);
  transform: translateY(-2px) scale(1.08);
}

/* Correcta */
.match-obj.correct {
  border-color: #22c55e;
  animation: matchCorrect .35s ease;
}

/* Incorrecta */
.match-obj.wrong {
  border-color: #ef4444;
  animation: matchWrong .25s ease;
}

/* ---------- Animaciones ---------- */

@keyframes matchFloat {
  0%   { transform: translateY(0px); }
  50%  { transform: translateY(-8px); }
  100% { transform: translateY(0px); }
}

@keyframes matchCorrect {
  0%   { transform: scale(1); }
  40%  { transform: scale(1.15); }
  100% { transform: scale(1); }
}

@keyframes matchWrong {
  0%   { transform: translateX(0); }
  25%  { transform: translateX(-6px); }
  50%  { transform: translateX(6px); }
  75%  { transform: translateX(-6px); }
  100% { transform: translateX(0); }
}

/* ===== Dino Safari ===== */
.safari-header{
  display: flex;
  max-width: 1100px;
  margin: 12px auto 16px;
  padding: 22px 40px;
  border-radius: 28px;
  background: #f7fbff;
  box-shadow: 0 16px 40px rgba(21, 94, 239, .10);
  gap: 28px;                   /* separación entre texto y silueta */
}

/* Texto "Encuentra este dinosaurio" */
.safari-instruction{
  margin: 0;
  font-weight: 800;
  font-size: clamp(26px, 2.7vw, 32px);
  color: #0f172a;
  text-align: center;
}

.safari-target{
  width: 155px;
  height: 155px;
  object-fit: contain;
  filter: drop-shadow(0 10px 18px rgba(15,23,42,.25));
}

.safari-target.silhouette{
  filter:
    grayscale(1)
    brightness(0.25)
    contrast(2.2)
    drop-shadow(0 12px 22px rgba(15,23,42,.45));
}

.safari-stage{
  position: relative;
  width: min(980px, 96%);
  height: min(520px, 60vh);
  margin: 10px auto 0;
  border-radius: 28px;
  overflow: hidden;
  box-shadow: 0 20px 40px rgba(15,23,42,.22);
  background: url("img/dino-dig/dino-bg.png") center/cover no-repeat;
}

.safari-stage.focus::before{
  content:"";
  position:absolute;
  inset:0;
  background:rgba(15,23,42,.45);
  backdrop-filter: blur(2px);
  z-index:3;
}

.safari-layer{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
}

.safari-ground{
  position:absolute;
  left:0;
  bottom:-25px;
  width:100%;
  height:auto;
  pointer-events:none;
  z-index:1;
}

.safari-bush-row{
  position:absolute;
  left:0;
  right:0;
  bottom:6%;
  display:flex;
  justify-content:space-around;
  align-items:flex-end;
  padding:0 75px;
  gap:40px;
  z-index:2;
  transition: opacity .32s ease;
}

.safari-bush-row.hidden{
  opacity:0;
  pointer-events:none;
}

.safari-bush{
  position:relative;
  width:10px;
  height:10px;   /* del .safari-bush */
  background:transparent;
  border:none;
  cursor:pointer;
  padding:0;
}

.safari-bush-img{
  position:absolute;
  left:50%;
  bottom:-130px;
  transform:translateX(-50%);
  width:250px;
  height:400px;
  object-fit:contain;
  z-index:2;
  filter: drop-shadow(0 12px 24px rgba(15,23,42,.45));
}

.safari-dino-peek{
  position:absolute;
  left:50%;
  bottom:-10px;
  width:160px;
  height:170px;
  filter: blur(1px);
  transform:translateX(-50%) translateY(12px);
  transform-origin:bottom center;
  object-fit:contain;
  z-index:1;
  transition:transform .28s ease, opacity .25s ease;
}

.safari-bush.peek .safari-dino-peek{
  transform:translateX(-50%) translateY(-10px);
}

.safari-dino-big{
  position:absolute;
  left:50%;
  bottom:12%;
  width:400px;
  height:400px;
  transform:translate(-50%, 18px) scale(.85);
  opacity:0;
  pointer-events:none;
  transition:opacity .32s ease, transform .32s ease;
  z-index:4;
}

.safari-dino-big img{
  width:100%;
  height:100%;
  object-fit:contain;
  filter: drop-shadow(0 20px 40px rgba(15,23,42,.4));
}

.safari-dino-big.show{
  opacity:1;
  transform:translate(-50%, 0) scale(1);
}

@keyframes safariHit{
  0%{ transform:translateX(-50%) translateY(-10px) scale(1); }
  60%{ transform:translateX(-50%) translateY(-26px) scale(1.12); }
  100%{ transform:translateX(-50%) translateY(-10px) scale(1); }
}

@keyframes safariWrong{
  0%{ transform:translateX(-50%) translateY(-10px); }
  25%{ transform:translateX(calc(-50% - 6px)) translateY(-10px); }
  50%{ transform:translateX(calc(-50% + 6px)) translateY(-10px); }
  100%{ transform:translateX(-50%) translateY(-10px); }
}

@keyframes safariBushShake{
  0%{ transform:translateY(0); }
  25%{ transform:translateY(-6px); }
  50%{ transform:translateY(0); }
  75%{ transform:translateY(-4px); }
  100%{ transform:translateY(0); }
}

.safari-bush.hit .safari-dino-peek{
  animation:safariHit .28s ease-out;
}

.safari-bush.wrong .safari-dino-peek{
  animation:safariWrong .26s ease;
}

.safari-bush.shake{
  animation:safariBushShake .45s ease;
}

/* Tarjeta que une cabecera + escenario */
.safari-card {
  max-width: 900px;         /* <-- antes 1120px */
  margin: 12px auto 0;
  background: #ffffff;
  border-radius: 24px;
  box-shadow: 0 18px 40px rgba(15,23,42,0.20);
  overflow: hidden;
}

/* Parte superior de la tarjeta: título + texto + silueta */
.safari-card-header {
  display: flex;
  flex-direction: column;       /* <-- apila texto + silueta centrados */
  align-items: center;          /* <-- centra horizontal */
  justify-content: center;      /* <-- centra vertical */
  gap: 14px;
  padding: 26px 24px 24px;      /* <-- más compacto */
  background: linear-gradient(135deg, #e0f2ff, #fdf2ff);
  text-align: center;
}

/* Bloque de texto */
.safari-card-text {
  flex: 1;
  min-width: 0;
}

.safari-title {
  font-size: 1.8rem;
  font-weight: 800;
  margin: 0;
  color: #111827;
}

/* Contenedor de la silueta */
.safari-target-wrap {
  display: flex;
  justify-content: center;
  width: 100%;
}

/* Imagen del dino objetivo */
.safari-target {
  width: 200px;
  height: auto;
  margin: 0 auto;
  filter: drop-shadow(0 12px 18px rgba(15,23,42,.35));
}

/* Silueta negra */
.safari-target.silhouette {
  filter:
    grayscale(1)
    brightness(0.25)
    contrast(2.1)
    drop-shadow(0 12px 20px rgba(15,23,42,.55));
  opacity: 0.95;
}

/* Cuando se quite la silueta (si algún día quieres mostrar el color) */
.safari-target.reveal {
  filter: none;
}

